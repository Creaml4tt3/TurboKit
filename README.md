**Prerequisites**: Node 14 or 15

---

# ðŸ‘‡ Start Here

Please make sure to use Node 14 or 15 before starting the setup process.

## ðŸ”¨ Start Dev Mode

1. run `npm i` to install dependencies
2. run `npm start` to start a local development server

## ðŸš§ First Time Setup

- **Website Info**

  1. open `gulpfile.mjs` and update `config = {...}` object with your new website info (siteName, siteURL, androidColor, cacheId...)

- **Icons + Manifest**
  1. place a copy of your logo (should be in SVG + named `logo.svg`) inside the `config` folder
  2. run `npm run favicon` to generate all icons/favicon/manifest/...
- **Fonts**
  1. change `config/font.json` to specify which fonts you want to use from Google Fonts
     - specify any font family (Roboto...) & styles (400,300italic...) in json file
     - specify a web safe font as a fallback for each custom font. Customize fallback font properties to minimize CLS using this tool: https://meowni.ca/font-style-matcher/ 
  2. run `npm run font` to automatically download/generate all fonts extensions/styles...

## ðŸš€ Build For Production

1. run `npm run image` to minify/resize images <br> <small>**note:** run this only once, but you have to rerun it if you add any new images to the `img` folder</small>
2. run `npm run build` to build for production
3. run `npm run netlify` or `npm run firebase` to deploy to your provider of choice (or just push to Github if you are using Cloudflare Pages / Netlify CD)

<br>

---

---

# ðŸ‘‡ Important

### ðŸ“· Images

- You should **wrap every `img` tag with a `picture` tag**. Also you should use `data-src` instead of the normal `src` attribute to lazy load images

  <small>Example:</small>

  ```
    <picture>
    <img data-src="./img/example.png" alt="example" height="50" width="50" />
    </picture>
  ```

  <small>**note:** All images are **lazy loaded** by default, but you can customize this in `util/shared.js`</small>

- **Faster Build Tip**
  - To avoid long build times in CI when deploying for example to `Netlify` commit your `dist/img` folder to your Github repo so you don't have to run the `npm run image` command on every deploy.

<br>

### ðŸš§ Failure of `npm i` fix

Sometimes `npm i` fails, this has nothing to do with the TurboKit script.

It's an issue related to the image processing library `sharp`.

### in CD/CI

To fix this issue simply set the following environment variables in your CD/CI config (netlify, cloudflare pages...)

```
NODE_VERSION: 14.17.5
```
```
PYTHON_VERSION: 3.7
```

### in Window / MacOS / Ubuntu
use `nvm` to switch to node version `14` or `15` and then run npm install.

Note: using node `16` or `17` or later might make `sharp` installation fail and then thus stop the `npm i` task


---

---

# ðŸ“œLearn More

### â˜• All `package.json` Scripts

#### Development

- `npm start`
  - start local development server

#### First Time Setup

- `npm run favicon`
  - generates PWA favicons, manifests and injects them into HTML files

- `npm run font`
  - downloads fonts from 'Google Font' as specified in `config/fonts.json`
  - injects them into `shared/css/shared.css`

#### Production

- `npm run image`
  - This script should be run only if you have added new images to your `src/img` folder. All the images that the script generates will go to `img` folder

- `npm run build`
  - minify, bundle and build for production files will output everything to `dist` folder. check `build` task in `gulpfile.mjs` to understand everything that this command does. (you should run it before every deploy)
  
- `npm run full`
  - run a full build: will run both commands `npm run image` and 'npm run build'

#### Deploy

- `npm run netlify`
  - deploy website to netlify (this is manual deployment. Of course, you can use netlify auto deploy on Github push)
  
- `npm run firebase`
  - deploy website to firebase

#### Maintenance

- `npm run format`
  - format all `src` folder files

- `npm run test`
  - run a local lighthouse test of the `dist` folder

- `npm run test-live`
  - run a lighthouse test of a live website in production (change `siteUrl` property in `gulpfile.mjs` config object before running this )

- `npm run update`
  - update all `package.json` dependencies and install them

### ðŸ“‚ folder structure

```
â”œâ”€â”€ config         # fonts/favicon/eslint/prettier... configuration files
â”œâ”€â”€ dist           # all build production files
â”œâ”€â”€ img            # all production images generated by `npm run image`
â”œâ”€â”€ src            # all source files
â”‚   â”œâ”€â”€ audio             # all your audio files
â”‚   â”œâ”€â”€ font              # generated fonts by `npm run font` command
â”‚   â”œâ”€â”€ img               # all your source images
â”‚   â”œâ”€â”€ json              # all your source json (lottie files...)
â”‚   â”œâ”€â”€ meta              # all icons + web manifest
â”‚   â”œâ”€â”€ pages             # all your website pages (html,css,js)
â”‚   â”‚   â”œâ”€â”€ css               # all libraires CSS files
â”‚   â”‚   â””â”€â”€ js                # all libraires JS files
â”‚   â”œâ”€â”€ util              # utility files shared between all pages
â”‚   â”‚   â”œâ”€â”€ shared.css        # shared CSS file
â”‚   â”‚   â””â”€â”€ shared.js         # shared JS file
â”‚   â”œâ”€â”€ video             # all video files
â”œâ”€â”€ .prettierrc     # Configure prettier formatting rules
â”œâ”€â”€ netlify.toml    # Configure netlify hosting
â”œâ”€â”€ firebase.json   # Configure firebase hosting
â””â”€â”€ ...
```
